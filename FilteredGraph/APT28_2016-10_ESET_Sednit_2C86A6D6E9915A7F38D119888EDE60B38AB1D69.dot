digraph spade2dot {
graph [rankdir = "RL"];
node [fontname="Helvetica" fontsize="8" style="filled" margin="0.0,0.0"];
edge [fontname="Helvetica" fontsize="8"];
"1" [label="path:C:\ntype:Artifact\nversion:3\nclass:File System" shape="ellipse" fillcolor="khaki1"];
"2" [label="path:C:\ntype:Artifact\nversion:4\nclass:File System" shape="ellipse" fillcolor="khaki1"];
"3" [label="path:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\ngen.log\ntype:Artifact\nversion:40\nclass:File System" shape="ellipse" fillcolor="khaki1"];
"4" [label="path:C:\\Users\\mathieu\\AppData\\Roaming\\lsasrvi.dll\ntype:Artifact\nversion:2\nclass:File System" shape="ellipse" fillcolor="khaki1"];
"5" [label="description:Console Window Host\npid:3884\ntype:Process\nversion:10.0.14393.0 (rs1_release.160715-1616)\ncommandline:\\??\\C:\\WINDOWS\\system32\\conhost.exe 0xffffffff -ForceV1\nppid:940\nimagepath:C:\\WINDOWS\\system32\\conhost.exe\nname:conhost.exe\ncompany:Microsoft Corporation\narch:64-bit" shape="box" fillcolor="lightsteelblue1"];
"6" [label="path:C:\\Users\\mathieu\\AppData\\Local\\Temp\\lsasrvi.dll\ntype:Artifact\nversion:2\nclass:File System" shape="ellipse" fillcolor="khaki1"];
"7" [label="path:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\ngen.log\ntype:Artifact\nversion:42\nclass:File System" shape="ellipse" fillcolor="khaki1"];
"8" [label="path:C:\\Windows\\Microsoft.NET\\ngennicupdatelock.dat\ntype:Artifact\nversion:24\nclass:File System" shape="ellipse" fillcolor="khaki1"];
"9" [label="path:C:\\Users\\mathieu\\AppData\\Roaming\\lsasrvi.dll\ntype:Artifact\nversion:1\nclass:File System" shape="ellipse" fillcolor="khaki1"];
"10" [label="path:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\ngen.log\ntype:Artifact\nversion:41\nclass:File System" shape="ellipse" fillcolor="khaki1"];
"11" [label="description:\npid:940\ntype:Process\nversion:\ncommandline:C:\\Users\\mathieu\\Downloads\\Malware\\executable\\APT28_2016-10_ESET_Sednit_2C86A6D6E9915A7F38D119888EDE60B38AB1D69.exe \nppid:3708\nimagepath:C:\\Users\\mathieu\\Downloads\\Malware\\executable\\APT28_2016-10_ESET_Sednit_2C86A6D6E9915A7F38D119888EDE60B38AB1D69.exe\nname:APT28_2016-10_ESET_Sednit_2C86A6D6E9915A7F38D119888EDE60B38AB1D69.exe\ncompany:\narch:32-bit" shape="box" fillcolor="lightsteelblue1"];
"12" [label="path:C:\\Users\\mathieu\\AppData\\Local\\Temp\\03721win.sys\ntype:Artifact\nversion:1\nclass:File System" shape="ellipse" fillcolor="khaki1"];
"13" [label="path:C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\ngenrootstorelock.dat\ntype:Artifact\nversion:12\nclass:File System" shape="ellipse" fillcolor="khaki1"];
"14" [label="description:Windows host process (Rundll32)\npid:4128\ntype:Process\nversion:10.0.14393.0 (rs1_release.160715-1616)\ncommandline:''C:\\Windows\\System32\\rundll32.exe'' ''C:\\Users\\mathieu\\AppData\\Local\\Temp\\lsasrvi.dll'',init\nppid:940\nimagepath:C:\\Windows\\SysWOW64\\rundll32.exe\nname:rundll32.exe\ncompany:Microsoft Corporation\narch:32-bit" shape="box" fillcolor="lightsteelblue1"];
"15" [label="path:C:\\Users\\mathieu\\AppData\\Local\\Temp\\lsasrvi.dll\ntype:Artifact\nversion:1\nclass:File System" shape="ellipse" fillcolor="khaki1"];
"1" -> "14" [label="(duration:0.0001683\ntime:10:15:53.6225106 AM\ndetail:Offset: 0, Length: 36,864, I/O Flags: Non-cached, Paging I/O, Synchronous Paging I/O, Priority: Normal\ntype:WasGeneratedBy\ncategory:Write\noperation:WriteFile)" color="red" style="solid"];
"14" -> "6" [label="(duration:0.0000013\ntime:10:15:53.6365484 AM\ndetail:Information: Owner\ntype:Used\ncategory:Read Metadata\noperation:QuerySecurityFile)" color="green" style="solid"];
"13" -> "5" [label="(duration:0.0002073\ntime:10:22:59.0311632 AM\ndetail:Desired Access: Generic Write, Read Attributes, Delete, Disposition: OverwriteIf, Options: Synchronous IO Non-Alert, Non-Directory File, Delete On Close, Attributes: n/a, ShareMode: None, AllocationSize: 0, OpenResult: Created\ntype:WasGeneratedBy\ncategory:Write\noperation:CreateFile)" color="red" style="solid"];
"14" -> "11" [label="(time:10:15:53.4692919 AM\ntype:WasTriggeredBy)" color="blue" style="solid"];
"14" -> "6" [label="(duration:0.0000029\ntime:10:15:53.6227495 AM\ndetail:AllocationSize: 36,864, EndOfFile: 34,304, NumberOfLinks: 1, DeletePending: False, Directory: False\ntype:Used\ncategory:Read Metadata\noperation:QueryStandardInformationFile)" color="green" style="solid"];
"6" -> "11" [label="(duration:0.0001006\ntime:10:15:52.1878793 AM\ndetail:Offset: -1, Length: 34,304, Priority: Normal\ntype:WasGeneratedBy\ncategory:Write\noperation:WriteFile)" color="red" style="solid"];
"12" -> "11" [label="(duration:0.0803664\ntime:10:15:52.1037596 AM\ndetail:Desired Access: Generic Write, Read Attributes, Disposition: OverwriteIf, Options: Synchronous IO Non-Alert, Non-Directory File, Attributes: H, ShareMode: Read, AllocationSize: 0, OpenResult: Created\ntype:WasGeneratedBy\ncategory:Write\noperation:CreateFile)" color="red" style="solid"];
"4" -> "11" [label="(duration:0.0000990\ntime:10:15:52.1869974 AM\ndetail:Offset: -1, Length: 34,304, Priority: Normal\ntype:WasGeneratedBy\ncategory:Write\noperation:WriteFile)" color="red" style="solid"];
"10" -> "5" [label="(duration:0.0001116\ntime:10:22:59.2759784 AM\ndetail:Offset: -1, Length: 95, Priority: Normal\ntype:WasGeneratedBy\ncategory:Write\noperation:WriteFile)" color="red" style="solid"];
"7" -> "5" [label="(duration:0.0000825\ntime:10:22:59.2789553 AM\ndetail:Offset: -1, Length: 59, Priority: Normal\ntype:WasGeneratedBy\ncategory:Write\noperation:WriteFile)" color="red" style="solid"];
"5" -> "11" [label="(time:10:16:00.8276590 AM\ntype:WasTriggeredBy)" color="blue" style="solid"];
"3" -> "5" [label="(duration:0.0000952\ntime:10:22:59.0055569 AM\ndetail:Offset: -1, Length: 273, Priority: Normal\ntype:WasGeneratedBy\ncategory:Write\noperation:WriteFile)" color="red" style="solid"];
"11" -> "6" [label="(duration:0.0000025\ntime:10:15:53.4479927 AM\ndetail:CreationTime: 5/4/2017 10:21:58 AM, LastAccessTime: 5/4/2017 10:21:58 AM, LastWriteTime: 5/4/2017 10:21:58 AM, ChangeTime: 5/4/2017 10:21:58 AM, FileAttributes: HSA\ntype:Used\ncategory:Read Metadata\noperation:QueryBasicInformationFile)" color="green" style="solid"];
"8" -> "5" [label="(duration:0.0002693\ntime:10:22:59.2770048 AM\ndetail:Desired Access: Generic Write, Read Attributes, Delete, Disposition: OverwriteIf, Options: Synchronous IO Non-Alert, Non-Directory File, Delete On Close, Attributes: n/a, ShareMode: None, AllocationSize: 0, OpenResult: Created\ntype:WasGeneratedBy\ncategory:Write\noperation:CreateFile)" color="red" style="solid"];
"14" -> "6" [label="(duration:0.0000025\ntime:10:15:53.6248129 AM\ndetail:CreationTime: 5/4/2017 10:21:58 AM, LastAccessTime: 5/4/2017 10:21:58 AM, LastWriteTime: 5/4/2017 10:21:58 AM, ChangeTime: 5/4/2017 10:21:58 AM, FileAttributes: HSA\ntype:Used\ncategory:Read Metadata\noperation:QueryBasicInformationFile)" color="green" style="solid"];
"15" -> "11" [label="(duration:0.0006257\ntime:10:15:52.1872400 AM\ndetail:Desired Access: Append Data/Add Subdirectory/Create Pipe Instance, Read Attributes, Synchronize, Disposition: OverwriteIf, Options: Synchronous IO Non-Alert, Non-Directory File, Attributes: HS, ShareMode: Write, AllocationSize: 0, OpenResult: Created\ntype:WasGeneratedBy\ncategory:Write\noperation:CreateFile)" color="red" style="solid"];
"2" -> "14" [label="(duration:0.0000152\ntime:10:15:53.6226965 AM\ndetail:EndOfFile: 34,304\ntype:WasGeneratedBy\ncategory:Write Metadata\noperation:SetEndOfFileInformationFile)" color="red" style="solid"];
"9" -> "11" [label="(duration:0.0001153\ntime:10:15:52.1868677 AM\ndetail:Desired Access: Append Data/Add Subdirectory/Create Pipe Instance, Read Attributes, Synchronize, Disposition: OverwriteIf, Options: Synchronous IO Non-Alert, Non-Directory File, Attributes: HS, ShareMode: Write, AllocationSize: 0, OpenResult: Created\ntype:WasGeneratedBy\ncategory:Write\noperation:CreateFile)" color="red" style="solid"];
}
